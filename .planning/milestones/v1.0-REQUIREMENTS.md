# Requirements Archive: v1.0 Fix + Discovery

**Archived:** 2026-02-11
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: Serapeum Fix + Discovery Milestone

## Overview

This milestone delivers multiple discovery entry points for academic paper research: seed papers, LLM-assisted query building, and topic browsing, all accessible through a guided startup wizard. Two bug fixes are also included.

## v1 Requirements

### Infrastructure (INFRA)

**INFRA-01: Database migration versioning**
- Schema changes use `PRAGMA user_version` with numbered migration scripts
- Migrations apply automatically on app startup in transaction
- Existing user databases upgrade safely without data loss
- Priority: High
- Source: CONCERNS.md (tech debt), research/SUMMARY.md (Phase 0)

**INFRA-02: Topics table schema**
- DuckDB topics table with topic_id, display_name, domain, field, subfield, topic hierarchy fields
- Populated from OpenAlex topics API and cached locally
- Priority: High
- Source: research/SUMMARY.md (Phase 0), needed by #40

### Discovery Features (DISC)

**DISC-01: Fix abstract embedding (#55)**
- Embedding logic processes abstracts (source_type = 'abstract'), not just documents
- "Embed Papers" button works for search notebook papers
- RAG chat returns relevant results from embedded abstracts
- Priority: Critical (blocks all search notebook chat)
- Source: GitHub #55, CONCERNS.md (known bug)

**DISC-02: Seed paper search (#25)**
- User can look up a paper by DOI, URL, or title autocomplete
- System fetches related works via OpenAlex (cites, cited_by, related_to)
- Related papers populate a new search notebook for filtering
- Priority: High
- Source: GitHub #25

**DISC-03: Meta-prompt query builder (#10)**
- User describes research interest in natural language
- LLM translates to OpenAlex filter syntax with validation against allowlist
- User can review and edit generated query before execution
- Generated query creates a search notebook
- Priority: High
- Source: GitHub #10

**DISC-04: OpenAlex topics & discovery (#40)**
- User can browse OpenAlex topic hierarchy (domain > field > subfield > topic)
- Selecting a topic shows papers filtered by that topic
- Topics cached locally in DuckDB for fast browsing
- Priority: Medium
- Source: GitHub #40

**DISC-05: Startup wizard UI (#43)**
- First-time users see guided onboarding: "Start with a paper, a topic, or a search query?"
- Wizard routes to appropriate discovery module based on choice
- Wizard can be skipped and dismissed permanently
- Priority: Medium
- Source: GitHub #43

**DISC-06: Rich sorting for search results (#54)**
- Search results sortable by FWCI, citation count, and outgoing citation count
- Sort controls visible in search notebook results view
- Null metrics handled gracefully (no "NA" display)
- Priority: Medium
- Source: GitHub #54

**DISC-07: Fix slide generation citation size (#51)**
- Citations in generated Quarto slides use appropriate font size
- Slides render without citation text overflowing slide boundaries
- Priority: Low
- Source: GitHub #51

## Out of Scope (v2+)

- Citation network graph (#53)
- Recursive abstract searching (#11)
- PDF image pipeline (#44)
- Local model support (#8)
- Conclusion synthesis (#27)
- Audio overview (#22)

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| INFRA-01 | Phase 0 | ✅ Complete |
| INFRA-02 | Phase 0 | ✅ Complete |
| DISC-01 | Phase 1 | ✅ Complete |
| DISC-02 | Phase 1 | ✅ Complete |
| DISC-03 | Phase 2 | ✅ Complete |
| DISC-06 | Phase 2 | ✅ Complete |
| DISC-04 | Phase 3 | ✅ Complete |
| DISC-05 | Phase 4 | ✅ Complete |
| DISC-07 | Phase 4 | ✅ Complete |

---
*Created: 2026-02-10*
